<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>TechForUs — Teknoloji Blogu</title>
  <meta name="description" content="TechForUs: Çok yazarlı, hızlı, statik barındırılan teknoloji blogu."/>
  <meta name="color-scheme" content="light dark"/>
  <meta property="og:title" content="TechForUs — Teknoloji Blogu"/>
  <meta property="og:description" content="Çok yazarlı, hafif ve hızlı bir teknoloji blogu."/>
  <link rel="stylesheet" href="/styles.css"/>
  <link rel="alternate" type="application/json" title="Posts JSON" href="/content/posts_index.json"/>
  <script defer src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
  <div class="wrap">
    <header>
      <a class="brand" href="/"><div class="logo" aria-hidden="true"></div><strong>TechForUs</strong></a>
      <nav>
        <a href="#yazilar">Yazılar</a>
        <a href="#konular">Konular</a>
        <a href="/admin/">Yazar Girişi</a>
      </nav>
    </header>

    <section class="hero">
      <h1>TechForUs</h1>
      <p>Topluluktan güç alan teknoloji notları: Kubernetes, Cloud, Windows, Güvenlik ve daha fazlası.</p>
      <div class="search">
        <input id="q" placeholder="Ara: Kubernetes, Docker, Windows, Azure…"/>
      </div>
      <div id="tags"></div>
    </section>

    <section id="yazilar" class="posts"></section>

    <section id="konular" class="hero" style="margin-top:24px">
      <h2>Konular</h2>
      <p class="muted">Kubernetes • Linux • Windows Server • Cloudflare • DevOps • Ağ • Güvenlik</p>
    </section>

    <footer>© <span id="y"></span> TechForUs · <a href="/admin/">/admin</a></footer>
  </div>

<script>
const $list = document.querySelector('.posts');
const $q = document.getElementById('q');
const $tags = document.getElementById('tags');
document.getElementById('y').textContent = new Date().getFullYear();

async function loadIndex(){
  const res = await fetch('/content/posts_index.json', {cache:'no-store'});
  const data = await res.json();
  return data.posts || [];
}

function render(items){
  $list.innerHTML = '';
  const tagset = new Set();
  items.forEach(p => (p.tags||[]).forEach(t=>tagset.add(t)));
  $tags.innerHTML = '';
  [...tagset].sort().forEach(t=>{
    const span = document.createElement('span'); span.className='tag'; span.textContent = '#' + t;
    span.onclick = ()=>filter(t); $tags.appendChild(span);
  });

  items.forEach(p=>{
    const el = document.createElement('article');
    el.className = 'card';
    const date = new Date(p.date).toLocaleDateString('tr-TR');
    el.innerHTML = `
      <div class="meta">${date} · ${(p.tags||[]).map(t=>`#${t}`).join(' ')}</div>
      <h3>${p.title}</h3>
      <p>${p.excerpt||''}</p>
      <a class="btn" href="/post.html?slug=${encodeURIComponent(p.slug)}">Oku</a>
    `;
    $list.appendChild(el);
  });
}

let ALL=[];
function filter(q){
  const n = (q||'').toLowerCase().trim();
  const f = ALL.filter(p => [p.title,p.excerpt,...(p.tags||[])].join(' ').toLowerCase().includes(n));
  render(f);
}
$q.addEventListener('input', e=>filter(e.target.value));

loadIndex().then(posts=>{ ALL = posts.sort((a,b)=>b.date.localeCompare(a.date)); render(ALL); });
</script>
</body>
</html>
